---
// src/components/NajalImageGallery.astro

import NajalHeading from '@/components/NajalHeading.astro';
import NajalText from '@/components/NajalText.astro';
import { Carousel } from '@/components/ui/Carousel.tsx';
// --- PASO 1: Importamos getImage y las imágenes desde src/assets ---
import { getImage } from 'astro:assets';
import image1 from '@/assets/gallery/modern-office.png'; // Asegúrate que la ruta sea correcta
import image2 from '@/assets/gallery/business-meeting-collaboration.png';
import image3 from '@/assets/gallery/team-collaboration.png';


// Datos originales de la galería, ahora con la referencia al import
const galleryImagesData = [
  { id: "1", src: image1, alt: "Oficina moderna", title: "Diseño Innovador", description: "Espacios de trabajo que inspiran creatividad y colaboración." },
  { id: "2", src: image2, alt: "Reunión de negocios", title: "Soluciones Elegantes", description: "Funcionalidad y estética unidas para potenciar tus proyectos." },
  { id: "3", src: image3, alt: "Colaboración de equipo", title: "Colaboración Total", description: "Herramientas que facilitan la comunicación y el trabajo en equipo." },
];

// --- PASO 2: Procesamos las imágenes para optimizarlas ---
const optimizedGalleryImages = await Promise.all(
  galleryImagesData.map(async (image) => {
    const optimizedSrc = await getImage({
      src: image.src,
      width: 1280, // Ancho para una buena visualización en el carrusel
      height: 720,
      format: 'webp',
      quality: 85,
    });

    return {
      ...image, // Mantenemos id, alt, title, description
      src: optimizedSrc.src, // Reemplazamos el src con la ruta a la imagen optimizada
    };
  })
);

---
<section class="py-20 bg-background transition-colors duration-300">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-12">
      <NajalHeading level={2} variant="primary" className="mb-4">
        Galería de Proyectos
      </NajalHeading>
      <NajalText size="lg" className="max-w-2xl mx-auto">
        Explora nuestros diseños y descubre la calidad en cada detalle.
      </NajalText>
    </div>
    
    <Carousel
      client:visible
      items={optimizedGalleryImages}
      opts={{
        loop: true,
        align: "start",
      }}
    />
  </div>
</section>